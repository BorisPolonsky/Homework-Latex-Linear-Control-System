%%Very Important!!! Please input your personal code and name here!
%%请在此输入你的个人代码和姓名（请用拼音，不要用汉字）。非常重要！！
\def\mycode{}
\def\myname{}
\def\myid{}


%%---DO NOT MODIFY THE FOLLOWING COMMANDS!---
%%──以下部分请不要修改!──
\documentclass{ctexart}\pagestyle{empty}
\usepackage{latexsym,afterpage,amssymb,amsmath,amsthm,amsbsy,amsopn,amstext,amsxtra,amscd,color,multicol,bm,calc,lastpage,listings,indentfirst,ifpdf,CJK,CJKnumb,fancybox,fancyhdr,float,subfigure,times,longtable}%常用宏包
\usepackage{everypage,lastpage}
\usepackage{graphicx,hyperref}
\usepackage[left=3cm,right=3cm]{geometry}
\graphicspath{{./}{fig/}}

\pdfinfo{
/Keywords (Linear Systems Theory)
/Title (2016-09-30_LinSys2016-assignment-L02_C4.tex)
/Subject (Assignment-2,2016-09-30)
/Creator (c26e158309505f61889ee3b749c66e08)
/Author (\myname)
/Producer (\mycode)
/StudentID (\myid)
}

%%Load the package attachfile for attaching files in pdf files
\usepackage{attachfile}
\newcommand{\myattach}[2][\relax]{
\IfFileExists{#2}{
\attachfile{#2}{\ifx\relax#1\fbox{#2}\else\fbox{#1}\fi}
}{}
}


%%Load the package listings for typesetting program codes
\usepackage{listings,color}
\lstdefinelanguage{sysquake}{
keywords={include,import,const,decl,return,if,else,elseif,for,while,switch,break,continue,goto,main},
sensitive=true,commentstyle=\it\color{red},frame=TB,
morecomment=[l]{//},morecomment=[s]{/*}{*/},numbers=left,numberstyle=\tiny,
extendedchars=true,breaklines=true,
}
\lstset{language=sysquake}


\parindent=0pt
\newcounter{assignment}\setcounter{assignment}{2}
\newcounter{exercise}\setcounter{exercise}{0}
\def\exerciseskip{\vskip 0.6cm plus 0.3cm minus 0.3cm}
\def\solutionskip{\vskip 1cm plus 0.5cm minus 0.5cm}
\def\exercisewidth{0.8\textwidth}
\def\solutionwidth{0.8\textwidth}
\def\exercisecoloring{\color{blue}}
\def\solutioncoloring{\color{red}}
\def\textcoloring{\color{black}}

\newenvironment{exercise-c26e158309505f61889ee3b749c66e08}
{\stepcounter{exercise}\centering\textbf{\large \sc \exercisecoloring Exercise \arabic{assignment}.\arabic{exercise}}\nopagebreak\\[-0.1ex] \hfill\hfill\ovalbox\bgroup\begin{minipage}{\exercisewidth}\exercisecoloring}
{\end{minipage}\egroup\hfill\hfill\exerciseskip}

\newenvironment{solution-c26e158309505f61889ee3b749c66e08}
{\centerline{\textbf{\large \sc \solutioncoloring \underline{Solution}}}\par \begingroup\textcoloring}
{\hfill\hfill $\Box$ \endgroup\solutionskip}

\def\mystar{{\color{red}$^\star$}}
\def\mydag{{\color{red}$^{\dagger}$}}
\newcommand\mylabel[2][]{\hypertarget{#2}{#1}}
\newcommand\myref[2][\fbox{$\star$}]{\hyperlink{#2}{#1}}

\def\mytitle{
\begin{center}
{\LARGE{Linear Systems Theory}} {
    \Large \normalsize
    \hspace*{12cm} Page \thepage\ of \pageref{LastPage}}\\
    Questions with \mystar\ are not compulsory,
    while questions with \mydag\ are compulsory.\\
    You need to solve at least one question in each assignment.\\
    The more questions you answer, the more points you gain.
\end{center}
}

\AddEverypageHook{
\fancyhf{}%
\mytitle
}


%%---You may add your own definitions here---
%%──你自己定义的命令可以放在这里──
\def\R{\mathcal{R}}
\def\Q{\mathcal{Q}}
\def\C{\mathcal{C}}
\def\F{\mathcal{F}}

%%---DO NOT MODIFY THE FOLLOWING COMMANDS!---
%%──以下部分请不要修改!──
\begin{document}%
\begin{CJK*}{GBK}{kai}
%-------版面的线框用页眉元素表现--------
%---第一页与众不同---
\newsavebox{\firstpgframe}
\sbox{\firstpgframe}{\parbox{157mm}{
\begin{center}
\begin{minipage}[t][153mm][t]{157mm}
\makebox[4mm][l]{\fbox{\parbox[t][153mm][t]{157mm}{\ }}}
\end{minipage}
\end{center}
}}
\vspace*{-6mm}

\newsavebox{\zdx}
\sbox{\zdx}
	{\parbox{412pt}{
	\centering \CJKfamily{kai}
代~码(Code)\underline{\makebox[20mm][c]{\mycode}}~学~号(ID)\underline{\makebox[30mm][c]{-\myid-}}~~~姓~名(Name)\underline{\makebox[30mm][c]{\myname}}

\vspace{3mm}
\dotfill{}装\dotfill{}订\dotfill{}线\dotfill{}(Gutter)\dotfill{}
}}
\setlength{\marginparsep}{-10mm}
\reversemarginpar
\marginpar{
\parbox{10mm}{\vspace{3cm}
\rotatebox[origin=c]{90}{
\usebox{\zdx}
}
}}

%%Attach files (tex file;source code;figures;data file;rar archive;etc.)
%%请在此用命令\myattach{file}插入你的各种源文件（tex文件，源程序，图片文件，数据文件，压缩包，等等）
\myattach{\jobname.tex}
\myattach{UnitMassSystem.sq}
\myattach{figure2.png}
\myattach{Schmidt.sq}
\myattach{LinearCircuit2-1.png}
\vskip 1cm

%%Main Text: Please provide your solutions here.
%%正文：请在此查看你的作业，并填写你的答案。


\begin{exercise-c26e158309505f61889ee3b749c66e08}%
Try to analyze the Feedback Amplifier invented by Harold Black in 1927.
Why it can work well in case of noisy input $V_1$?
Give a mathematical model for the circuit shown on Page 12 of Astrom's slides on Introduction to Automatic Control. 
Use Sysquake to simulate the usefulness of the feedback amplifier.
\end{exercise-c26e158309505f61889ee3b749c66e08}

\begin{solution-c26e158309505f61889ee3b749c66e08}
 Please put your solution and/or program here ...
 Assume
 $$i_{R_{1}}=i_{R_{2}}$$
 We have following equations. 
 $$\frac{V-V_{1}}{R_{1}}=\frac{V_{2}-V}{R_{2}}$$
 $$V_{2}=-AV$$
 with these two equations we obtain:
 $$\frac{V_{2}}{V_{1}}=-\frac{R_{2}}{R_{1}}\frac{1}{1+\frac{1}{A}(1+\frac{R_{2}}{R_{1}})}$$
 Given $A=10^{5}$,$\frac{R_{2}}{R_{1}}=100$, we have $\frac{V_{2}}{V_{1}}=-99.8991$. 
 From the analysis it's clear that the open loop gain is determined by passive components and the Amplification factor $A$. If we have $A=infinite$, then $\frac{V_{2}}{V_{1}}=-\frac{R_{2}}{R_{1}}$
 %\lstinputlisting{myprog01.sq}
\end{solution-c26e158309505f61889ee3b749c66e08}


\begin{exercise-c26e158309505f61889ee3b749c66e08}%
Show that any linear function $f: R^n\to R^m$ can
be written as $f (x) = Ax$ for some $A \in R^{m\times n}$.\\
\textbf{Hints:} Choose special vectors $e_1,e_2,\cdots, e_n$ and discuss $f(x)$ for $x=x_1 e_1+x_2 e_2+\cdots x_n e_n$ for arbitrary $x_1, x_2, \cdots, x_n$. 
\end{exercise-c26e158309505f61889ee3b749c66e08}
\begin{solution-c26e158309505f61889ee3b749c66e08}
 Please put your solution and/or program here ...
 \newline Assume the bases for $R^n$ and $R^m$ are $e_{1},e_{2},\cdots,e_{n}$ and $e_{1},e_{2},\cdots,e_{m}$
 
 $$f\begin{bmatrix}e_{1}&e_{2}&\cdots&e_{n}\end{bmatrix}=\begin{bmatrix}f(e_{1})&f(e_{2})&\cdots&f(e_{n})\end{bmatrix}$$
 for any $x^{T}=\begin{bmatrix}x_{1}&x_{2}&\cdots&x_{n}\end{bmatrix}$ belongs to $R^{n}$
 $$x=x_{1}e_{1}+x_{2}e_{2}+\cdots+x_{n}e_{n}$$
 \newline likewise we can represent $y^{T}$ which belongs to $R_{m}$ as
 $$\begin{bmatrix}e_{1}&e_{2}&\cdots&e_{m}\end{bmatrix}\begin{bmatrix}y_{1}&y_{2}&\cdots&y_{m}\end{bmatrix}^{T}$$
 $$f(x)=f(x_{1}e_{1}+x_{2}e_{2}+\cdots+x_{n}e_{n})$$
 $$=x_{1}f(e_{1})+x_{2}f(e_{2})+\cdots+x_{n}f(e_{n})$$
 $$=\begin{bmatrix}f(e_{1})&f(e_{2})&\cdots&f(e_{n})\end{bmatrix}x$$
 $$=\begin{bmatrix}f(e_{1})&f(e_{2})&\cdots&f(e_{n})\end{bmatrix}x=Ax$$
 hence,
 $$A=\begin{bmatrix}f(e_{1})&f(e_{2})&\cdots&f(e_{n})\end{bmatrix}$$
 %\lstinputlisting{myprog01.sq}
\end{solution-c26e158309505f61889ee3b749c66e08}

\begin{exercise-c26e158309505f61889ee3b749c66e08}%
Show that $y=Ax$ for the linear static circuit on Page 11 of course slides (lecture 02)
and write down the impedance matrix $A$.
\end{exercise-c26e158309505f61889ee3b749c66e08}
\begin{solution-c26e158309505f61889ee3b749c66e08}
 Please put your solution and/or program here ...
 \newline
 \includegraphics[width=0.8\textwidth]{LinearCircuit2-1.png}
 \newline Apply KCL to node A we obtain:$$i_{b}=x_{1}-\frac{y_{1}}{R_{1}}$$
 Apply KCL to node B we obtain:$$\frac{y_{2}+x_{2}}{R}=\frac{y_{2}}{R_{2}}+(1-\beta)i_{b})=\frac{y_{2}}{R_{2}}+(1-\beta)(x_{1}-\frac{y_{1}}{R_{1}})$$
 Apply KVL to the loop represented by the red rectangle in the figure, we have:
 $$y_{1}=i_{b}R_{b}+x_{2}+y_{2}=(x1-\frac{y_{1}}{R_{1}})R_{b}+x_{2}+y_{2}$$
 With these to equations obtain, we have
 $$
 \begin{bmatrix}1+\frac{R_{b}}{R_{1}}&-1\\ \frac{1-\beta}{R_{1}}&\frac{1}{R}-\frac{1}{R_{2}}
\end{bmatrix}
\begin{bmatrix}y_{1}\\y_{2}\\ \end{bmatrix}=
\begin{bmatrix}R_{b}&1\\ 1-\beta&-\frac{1}{R}\end{bmatrix}
\begin{bmatrix}x_{1}\\x_{2}\\ \end{bmatrix}$$
Hence,
$$\begin{bmatrix}y_{1}\\y_{2}\\ \end{bmatrix}=
\frac{1}{(1+\frac{R_{b}}{R_{1}})(\frac{1}{R}-\frac{1}{R_{2}})+\frac{1-\beta}{R_{1}}}
\begin{bmatrix}\frac{1}{R}-\frac{1}{R_{2}}&1\\-\frac{1-\beta}{R_{1}}&1+\frac{R_{b}}{R_{1}}\end{bmatrix}\begin{bmatrix}R_{b}&1\\ 1-\beta&-\frac{1}{R}\end{bmatrix}
\begin{bmatrix}x_{1}\\x_{2}\\ \end{bmatrix}$$
$$\begin{bmatrix}y_{1}\\y_{2}\end{bmatrix}=\frac{1}{(1+\frac{R_{b}}{R_{1}})(\frac{1}{R}-\frac{1}{R_{2}})+\frac{1-\beta}{R_{1}}}\begin{bmatrix}R_{b}(\frac{1}{R}-\frac{1}{R_{2}})+1-\beta&-\frac{1}{R_{2}}\\1-\beta&\frac{R_{1}(\beta-2)+R_{b}}{R_{1}^{2}}\end{bmatrix}\begin{bmatrix}x_{1}\\x_{2}\end{bmatrix}
$$
Furthurmore, for $R_{3}$ we have $y_{3}=\frac{x_{2}}{R_{3}}$, then we obtain
$$\begin{bmatrix}y_{1}\\y_{2}\\y_{3}\end{bmatrix}=\frac{1}{(1+\frac{R_{b}}{R_{1}})(\frac{1}{R}-\frac{1}{R_{2}})+\frac{1-\beta}{R_{1}}}
\begin{bmatrix}R_{b}(\frac{1}{R}-\frac{1}{R_{2}})+1-\beta&-\frac{1}{R_{2}}\\1-\beta&\frac{R_{1}(\beta-2)+R_{b}}{R_{1}^{2}}\\0&\frac{(1+\frac{R_{b}}{R_{1}})(\frac{1}{R}-\frac{1}{R_{2}})+\frac{1-\beta}{R_{1}}}{R_{3}}
\end{bmatrix}
\begin{bmatrix}x_{1}\\x_{2}\end{bmatrix}$$
In conclusion:
$$A=\frac{1}{(1+\frac{R_{b}}{R_{1}})(\frac{1}{R}-\frac{1}{R_{2}})+\frac{1-\beta}{R_{1}}}
\begin{bmatrix}R_{b}(\frac{1}{R}-\frac{1}{R_{2}})+1-\beta&-\frac{1}{R_{2}}\\1-\beta&\frac{R_{1}(\beta-2)+R_{b}}{R_{1}^{2}}\\0&\frac{(1+\frac{R_{b}}{R_{1}})(\frac{1}{R}-\frac{1}{R_{2}})+\frac{1-\beta}{R_{1}}}{R_{3}}
\end{bmatrix}$$
 %\lstinputlisting{myprog01.sq}
\end{solution-c26e158309505f61889ee3b749c66e08}

\begin{exercise-c26e158309505f61889ee3b749c66e08}%
Consider the mass system on Page 12 of course slides (lecture 02). Suppose $n=5$. 
\begin{enumerate}
\item Show that $y=Ax$ and figure out the matrix $A$.
\item Find sequence $x$ of applied forces so that $y=(10,5)$ at $t=n$.
\item Write a Sysquake program to verify your results.
\end{enumerate}
\end{exercise-c26e158309505f61889ee3b749c66e08}

\begin{solution-c26e158309505f61889ee3b749c66e08}
 Please put your solution and/or program here ...
 \newline Given that $F=ma$, m=1, it is clear that for the $k_{th}$ interval,
 $$v_{k}=y_{2}(k)=\sum_{i=1}^{k}x_{i}$$
 for $s=v_{0}t+\frac{1}{2}at^{2}$
 we have $s_{k+1}-s_{k}=y_{1}(k+1)-y_{1}(k)=y_{2}(k)+\frac{1}{2}x_{k+1}$
 $$y_{1}(k)=y_{1}(k-1)+y_{2}(k-1)+\frac{1}{2}x_{k}$$
 hence,
 $$y_{1}(k)=\sum_{i=0}^{k-1}y_{2}(i)+\frac{1}{2}(\sum_{i=1}^{k}x_{i})$$
 $$(y_{1}(0)=y_{2}(0)=0)$$
 for n=5
 $$y_{2}(5)=[1\ 1\ 1\ 1\ 1]X$$
 $$\frac{1}{2}\sum_{i=1}^{k}x_{i}=[\frac{1}{2}\ \frac{1}{2}\ \frac{1}{2}\ \frac{1}{2}\ \frac{1}{2}]X$$
 $$\sum_{i=0}^{4}y_{2}(i)=[1\ 1\ 1\ 1\ 1][y_{2}(0)\ y_{2}(1)\ y_{2}(2)\ y_{2}(3)\ y_{2}(4)]^{T}$$
 $$=[1\ 1\ 1\ 1\ 1](\begin{bmatrix}
     0 & 0 & 0 & 0 & 0 \\
     1 & 0 & 0 & 0 & 0 \\
     1 & 1 & 0 & 0 & 0 \\
     1 & 1 & 1 & 0 & 0 \\
     1 & 1 & 1 & 1 & 0 \\
\end{bmatrix}X)$$
$$=[4\ 3\ 2\ 1\ 0]X$$
hence,
$$y_{1}(5)=[4.5\ 3.5\ 2.5\ 1.5\ 0.5]X$$
Then we obtain matrix A:
$$A=\begin{bmatrix}
     4.5 & 3.5 & 2.5 & 1.5 & 0.5 \\
     1 & 1 & 1 & 1 & 1 \\
\end{bmatrix}$$
\newline 2:Matrix A is invertible if and only if n=2, in this case we have
$$A=\begin{bmatrix}
     1.5 & 0.5\\
     1 & 1 \\
\end{bmatrix}$$
$$y=Ax=[10\ 5]^{T}$$
$$x=A^{-1}y=
\begin{bmatrix}
     1 & -0.5\\
     -1 & 1.5 \\
\end{bmatrix}[10\ 5]^{T}$$
$$x=[7.5\ -2.5]^{T}$$
For n=1, there is no solution. for $n>2$,there are infinite solutions. And the dimension of the solution space equals to $n-2$
\newline 3:Implement a set of functions shown as below:
\lstinputlisting{UnitMassSystem.sq}
Run the following command:
\newline DisplayMotion([7.5 -2.5])
\newline The results are shown below, which are consistent with the conclusion drawn before:

pos =
         0
v =
         0
pos =
      3.75
v =
       7.5
pos =
        10
v =
         5
         
\includegraphics[width=0.8\textwidth]{figure2.png} 
\end{solution-c26e158309505f61889ee3b749c66e08}


\begin{exercise-c26e158309505f61889ee3b749c66e08}%
According to the algorithm shown on the course slides (lecture 04), 
write a Sysquake program to convert a group of arbitrary vectors into an orthonormal basis
and test your program with some examples.
\end{exercise-c26e158309505f61889ee3b749c66e08}

\begin{solution-c26e158309505f61889ee3b749c66e08}
 Please put your solution and/or program here ...
 Implement the Gram-Schmidt Procedure using Sysquake, the function is shown below:
\lstinputlisting{Schmidt.sq}
Let's test the function with some vectors
$$v_{1}=[1,2,3]^{T}v_{2}=[4,5,6]^{T}v_{3}=[7,8,9]^{T}$$
Run the following commands:
\newline M=[1,1,1;1,1,0;1,0,0]';
\newline M=Orthonormalize(M)
\newline We obtain the following result:
\newline M =
$$\begin{matrix}
    0.5774  &  0.4082  &  0.7071\\
    0.5774  &  0.4082  & -0.7071\\
    0.5774  & -0.8165  &       0\\
\end{matrix}$$
To test whether the set colomn vectors forms orthonormal basis of $R^{5}$, simply run the following command:
\newline M'*M
\newline And we obtain the result:
\newline  ans =
$$\begin{matrix}
1           &5.5511e-17 &   0\\
5.5511e-17  &         1 &   0\\
0           &         0 &   1\\
\end{matrix}$$
Given that there's possile data loss during float typed variable computations(which I've failed to fix in this case), the answer we obtained can be consider a 3 by 3 identical matrix, which indicates that the vectors had been converted into orthonormal basis through Gram-Schmidt Procedure.
\end{solution-c26e158309505f61889ee3b749c66e08}




\end{CJK*}
\end{document}



