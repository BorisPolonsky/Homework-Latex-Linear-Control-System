%%Very Important!!! Please input your personal code and name here!
%%请在此输入你的个人代码和姓名（请用拼音，不要用汉字）。非常重要！！
\def\mycode{}
\def\myname{}

%%---DO NOT MODIFY THE FOLLOWING COMMANDS!---
%%──以下部分请不要修改!──
\documentclass{ctexart}\pagestyle{empty}
\usepackage{latexsym,afterpage,amssymb,amsmath,amsthm,amsbsy,amsopn,amstext,amsxtra,amscd,color,multicol,bm,calc,lastpage,listings,indentfirst,ifpdf,CJK,CJKnumb,fancybox,fancyhdr,float,subfigure,times,longtable}%常用宏包
\usepackage{everypage,lastpage}
\usepackage{graphicx,hyperref}
\usepackage[left=3cm,right=3cm]{geometry}
\graphicspath{{./}{fig/}}

\pdfinfo{
/Keywords (Linear Systems Theory)
/Title (-MyTitle-)
/Subject (-Assignment-)
/Creator (-YourCode-)
/Author (\myname)
/Producer (\mycode)
}

%%Load the package attachfile for attaching files in pdf files
\usepackage{attachfile}
\newcommand{\myattach}[2][\relax]{
\IfFileExists{#2}{
\attachfile{#2}{\ifx\relax#1\fbox{#2}\else\fbox{#1}\fi}
}{}
}


%%Load the package listings for typesetting program codes
\usepackage{listings,color}
\lstdefinelanguage{Ox}{
keywords={include,import,const,decl,return,if,else,elseif,for,while,switch,break,continue,goto,main},
sensitive=true,commentstyle=\it\color{red},frame=TB,
morecomment=[l]{//},morecomment=[s]{/*}{*/},numbers=left,numberstyle=\tiny,
extendedchars=true,breaklines=true,
}
\lstset{language=Ox}


\parindent=0pt
\newcounter{assignment}\setcounter{assignment}{000}
\newcounter{exercise}\setcounter{exercise}{0}
\def\exerciseskip{\vskip 0.6cm plus 0.3cm minus 0.3cm}
\def\solutionskip{\vskip 1cm plus 0.5cm minus 0.5cm}
\def\exercisewidth{0.8\textwidth}
\def\solutionwidth{0.8\textwidth}
\def\exercisecoloring{\color{blue}}
\def\solutioncoloring{\color{red}}
\def\textcoloring{\color{black}}

\newenvironment{exercise}
{\stepcounter{exercise}\centering\textbf{\large \sc \exercisecoloring Exercise \arabic{assignment}.\arabic{exercise}}\nopagebreak\\[-0.1ex] \hfill\hfill\ovalbox\bgroup\begin{minipage}{\exercisewidth}\exercisecoloring}
{\end{minipage}\egroup\hfill\hfill\exerciseskip}

\newenvironment{solution}
{\centerline{\textbf{\large \sc \solutioncoloring \underline{Solution}}}\par \begingroup\textcoloring}
{\hfill\hfill $\Box$ \endgroup\solutionskip}

\def\mystar{{\color{red}$^\star$}} 
\def\mydag{{\color{red}$^{\dagger}$}} 
\newcommand\mylabel[2][]{\hypertarget{#2}{#1}}
\newcommand\myref[2][\fbox{$\star$}]{\hyperlink{#2}{#1}}

\def\mytitle{
\begin{center}
{\LARGE{Linear Systems Theory}} {
    \Large \normalsize
    \hspace*{12cm} Page \thepage\ of \pageref{LastPage}}\\
    Questions with \mystar\ are not compulsory, 
    while questions with \mydag\ are compulsory.\\
    You need to solve at least one question in each assignment.\\
    The more questions you answer, the more points you gain.
\end{center}
}

\AddEverypageHook{
\fancyhf{}%
\mytitle
}


%%---You may add your own definitions here---
%%──你自己定义的命令可以放在这里──
\def\R{\mathcal{R}}
\def\Q{\mathcal{Q}}
\def\C{\mathcal{C}}
\def\F{\mathcal{F}}

%%---DO NOT MODIFY THE FOLLOWING COMMANDS!---
%%──以下部分请不要修改!──
\begin{document}%
\begin{CJK*}{GBK}{kai}
%-------版面的线框用页眉元素表现--------
%---第一页与众不同---
\newsavebox{\firstpgframe}
\sbox{\firstpgframe}{\parbox{157mm}{
\begin{center}
\begin{minipage}[t][153mm][t]{157mm}
\makebox[4mm][l]{\fbox{\parbox[t][153mm][t]{157mm}{\ }}}
\end{minipage}
\end{center}
}}
\vspace*{-6mm}

\newsavebox{\zdx}
\sbox{\zdx}
	{\parbox{412pt}{
	\centering \CJKfamily{kai}
代~码(Code)\underline{\makebox[20mm][c]{\mycode}}~学~号(ID)\underline{\makebox[30mm][c]{}}~~~姓~名(Name)\underline{\makebox[30mm][c]{\myname}}

\vspace{3mm}
\dotfill{}装\dotfill{}订\dotfill{}线\dotfill{}(Gutter)\dotfill{}
}}
\setlength{\marginparsep}{-10mm}
\reversemarginpar
\marginpar{
\parbox{10mm}{\vspace{3cm}
\rotatebox[origin=c]{90}{
\usebox{\zdx}
}
}}

%%Attach files (tex file;source code;figures;data file;rar archive;etc.)
%%请在此用命令\myattach{file}插入你的各种源文件（tex文件，源程序，图片文件，数据文件，压缩包，等等）
\myattach{\jobname.tex}
\myattach{L04PlotPhaseDiagram.sq}
\myattach{L04PhaseDiagram.png}
\vskip 1cm

%%Main Text: Please provide your solutions here.
%%正文：请在此查看你的作业，并填写你的答案。
\begin{exercise}%
\mydag
Please program with sysquake to draw phase diagram of any ordinary differential equation, e.g..
$$\dot{x} = \left[\begin{array}{cc}
-0.5 & 1\\
-1 & 0.5
\end{array}\right]x
$$
\end{exercise}

\begin{solution}
 Please put your solution and/or program here ... 
 \\Implement a set of function shown as below:
 \lstinputlisting{L04PlotPhaseDiagram.sq}
 Run the following command:
\begin{verbatim}
 phaseplot([0 20],[1;-1])
 phaseplot([0 20],[0;1])
\end{verbatim}
We obtain the following result:
\begin{figure}[h!]
\includegraphics[width=\linewidth]{L04PhaseDiagram.png}
\end{figure}
 %\lstinputlisting{myprog01.ox}
\end{solution}

\begin{exercise}%
\mydag
Find the explicit solutions of $x_{n+1}=A x_{n}+b$ and $\dot{x} = Ax+b$, respectively. 
\end{exercise}

\begin{solution}
 Please put your solution and/or program here ... 
 \\1: 
 $$x_{n+1}=A x_{n}+b$$
 $$x_{n}=A x_{n-1}+b$$
 $$x_{n+1}-x_{n}=A(x_{n}-x_{n-1})$$
 $$x_{n+1}-x_{n}=A^{n}(x_{1}-x_{0}),(A^{0}=I)$$
 $$Ax_{n}+b-x_{n}=A^{n}(Ax_{0}+b-x_{0})$$
 $$(A-I)x_{n}=A^{n}(A-I)x_{0}+(A^{n}-I)b$$
 $$x_{n}=(A-I)^{-1}A^{n}(A-I)x_{0}+(A-I)^{-1}(A^{n}-I)b$$
 2: 
 \\Apply Laplace transformation to both sides of equation:
 $$sX(s)-x(0^{-})=AX(s)+b\frac{1}{s}$$
 $$X(s)=(sI-A)^{-1}x(0^{-})+\frac{1}{s}(sI-A)^{-1}b$$
 $$x(t)=e^{At}x(0^{-})+\left(\int_{0}^{t}e^{A\tau}bu(t-\tau)\,d\tau\right)$$, in which $u(t)$ is a unitstep function. 
 %\lstinputlisting{myprog01.ox}
\end{solution}

\begin{exercise}%
\mydag
\textit{Linear dynamical system with constant input.} We consider the system $\dot{x} = Ax + b$, with $x(t) \in R^{n}$. $A$ vector $x_{e}$ is an equilibrium point if $0 = Ax_{e} + b$. (This means that the constant trajectory $x(t) = x_{e}$ is a soluion of $\dot{x} = Ax + b$.)
\begin{enumerate}
    \item When is there an equilibrium point?
    \item When are there multiple equilibrium points?
    \item When is there a unique equilibrium point?
    \item Now suppose that $x_{e}$ is an equilibrium point. Define $z(t) = x(t) - x_{e}$. Show that $\dot{z} = Az$. From this, give a general formula for $x(t)$ (involving $x_{e}$, exp($tA$), $x(0)$).
    \item Show that if all eigenvalues of $A$ have negative real part, then there is exactly one equilibrium point $x_{e}$, and for any trajectory $x(t)$, we have $x(t) \to x_{e}$ as $t \to \infty$.
\end{enumerate}
\end{exercise}

\begin{solution}
 Please put your solution and/or program here ... 
 \\1: If $rank(A)=rank(A|b)$, there's at least 1 equilibrium point. 
 \\2: If $rank(A)=rank(A|b)<n$ there are multiple equilibrium points. 
 \\3: If $rank(A)=rank(A|b)=n$, there's only 1 equilibrium point. 
 \\4: $\dot{z}(t) = \dot{x}(t)=Ax(t)+b=A[z(t)+x_{e}]+b=Az(t)+Ax_{e}+b=Az(t)$. Hence, $z(t)=e^{At}z(0)$. Since $z(t)=x(t)-x_{e}$, we finally obtain $x(t)=e^{At}x(0)+(I-e^{At})x_{e}=e^{At}[x(0)-x_{e}]+x_{e}$. 
 \\5: For unique eigenvalues, the ith element of $e^{At}[x(0)-x_{e}]$ has the form of $\sum_{j=1}^{n}\beta_{ij}e^{\lambda_{j}t}$. For repeated eigenvalues, the result would be $\sum_{j=1}^{r}p_{ij}(t)e^{\lambda_{j}t}$ where $p_{ij}(t)$ has a degree less than that the multiplicity of the corresponding eigenvalue and $r$ is the number of distinct eigenvalues. Hence, if all eigenvalues have negative real part, then limit of the ith component of $e^{At}[x(0)-x_{e}]$ will be zero. Hence, $\lim\limits_{t \to \infty }{z(t)}=x_{e}$, which suggests that the system is stable. 
 %\lstinputlisting{myprog01.ox}
\end{solution}

\begin{exercise}%
\mystar
\textit{Invariance of the unit square.} Consider the linear dynamical system $\dot{x} = Ax$ with $A \in R^{2 \times 2}$. The unit square in $R^{2}$ is defined by
$$S = \{ x | - 1 \le x_{1} \le 1, - 1 \le x_{2} \le 1 \}.$$
\begin{enumerate}
    \item Find the exact conditions on $A$ for which the unit square $S$ is invariant under $\dot{x} = Ax$. Give the conditions as explicitly as possible.
    \item Consider the following statement: if the eigenvalues of $A$ are real and negative, then $S$ is invariant under $\dot{x} = Ax$. Either show that this is true, or give an explicit counterexample.
\end{enumerate}
\end{exercise}


\begin{solution}
 Please put your solution and/or program here ... 
 %\lstinputlisting{myprog01.ox}
\end{solution}


\end{CJK*}
\end{document}



