%%Very Important!!! Please input your personal code, name and student number here!
%%请在此输入你的个人代码、和姓名（请用拼音，不要用汉字）和学号。非常重要！！
\def\mycode{}
\def\myname{}
\def\myStudentNumber{}

%%---DO NOT MODIFY THE FOLLOWING COMMANDS!---
%%──以下部分请不要修改!──
% \documentclass{ctexart}\pagestyle{empty}
\documentclass{article}\pagestyle{empty}
\usepackage{latexsym,afterpage,amssymb,amsmath,amsthm,amsbsy,amsopn,amstext,amsxtra,amscd,color,multicol,bm,calc,lastpage,listings,indentfirst,ifpdf,CJK,CJKnumb,fancybox,fancyhdr,float,subfigure,times,longtable}%常用宏包
\usepackage{everypage,lastpage}
\usepackage{graphicx,hyperref}
\usepackage[left=3cm,right=3cm]{geometry}
\graphicspath{{./}{fig/}{theme0/}{pic15/}}

\pdfinfo{
/Keywords (Linear Systems Theory)
/Title (2016-12-16_LinSys2016-assignment-L06_C4.tex)
/Subject (Assignment-12,2016-12-16)
/Creator (\mycode)
/Author (\myname)
/Producer (\mycode)
}

%%Load the package attachfile for attaching files in pdf files
\usepackage{attachfile}
\newcommand{\myattach}[2][\relax]{
\IfFileExists{#2}{
\attachfile{#2}{\ifx\relax#1\fbox{#2}\else\fbox{#1}\fi}
}{}
}


%%Load the package listings for typesetting program codes
\usepackage{listings,color}
\lstdefinelanguage{Ox}{
keywords={include,import,const,decl,return,if,else,elseif,for,while,switch,break,continue,goto,main},
sensitive=true,commentstyle=\it\color{red},frame=TB,
morecomment=[l]{//},morecomment=[s]{/*}{*/},numbers=left,numberstyle=\tiny,
extendedchars=true,breaklines=true,
}
\lstdefinelanguage{sysquake}{
keywords={include,includeifexists,info,use,useifexists,const,private,public,global,profile,error,return,if,else,elseif,end,for,while,repeat,until,switch,break,catch,continue,define,function,otherwise,functions,init,figure,draw,menu,plot,line,separator,beginmenu,endmenu,beginsubmenu,endsubmenu,data,dragin,dragout,embeddedfile,export,extension,help,idle,import,input,keydown,make,mousedown,mousedoubleclick,mousedrag,mousedragcont,mouseout,mouseover,mousescroll,mouseup,output,publichandler,resize,terminate,title,userinterface,variable,variables,version,assert,warning,varargin,varargout},
sensitive=true,commentstyle=\it\color{red},frame=TB,
morecomment=[l]{//},morecomment=[s]{/*}{*/},numbers=left,numberstyle=\tiny,
extendedchars=true,breaklines=true,
}
\lstset{language=sysquake}


\parindent=0pt
\newcounter{assignment}\setcounter{assignment}{12}
\newcounter{exercise}\setcounter{exercise}{0}
\def\exerciseskip{\vskip 0.6cm plus 0.3cm minus 0.3cm}
\def\solutionskip{\vskip 1cm plus 0.5cm minus 0.5cm}
\def\exercisewidth{0.8\textwidth}
\def\solutionwidth{0.8\textwidth}
\def\exercisecoloring{\color{blue}}
\def\solutioncoloring{\color{red}}
\def\textcoloring{\color{black}}

\newenvironment{exercise-c26e158309505f61889ee3b749c66e08}
{\stepcounter{exercise}\centering\textbf{\large \sc \exercisecoloring Exercise \arabic{assignment}.\arabic{exercise}}\nopagebreak\\[-0.1ex] \hfill\hfill\ovalbox\bgroup\begin{minipage}{\exercisewidth}\exercisecoloring}
{\end{minipage}\egroup\hfill\hfill\exerciseskip}

\newenvironment{solution-c26e158309505f61889ee3b749c66e08}
{\centerline{\textbf{\large \sc \solutioncoloring \underline{Solution}}}\par \begingroup\textcoloring}
{\hfill\hfill $\Box$ \endgroup\solutionskip}

\def\mystar{{\color{red}$^\star$}} 
\def\mydag{{\color{red}$^{\dagger}$}} 
\newcommand\mylabel[2][]{\hypertarget{#2}{#1}}
\newcommand\myref[2][\fbox{$\star$}]{\hyperlink{#2}{#1}}

\def\mytitle{
\begin{center}
{\LARGE{Linear Systems Theory}} {
    \Large \normalsize
    \hspace*{12cm} Page \thepage\ of \pageref{LastPage}}\\
    Questions with \mystar\ are not compulsory, 
    while questions with \mydag\ are compulsory.\\
    You need to solve at least one question in each assignment.\\
    The more questions you answer, the more points you gain.
\end{center}
}

\AddEverypageHook{
\fancyhf{}%
\mytitle
}


%%---You may add your own definitions here---
%%──你自己定义的命令可以放在这里──
\def\R{\mathcal{R}}
\def\Q{\mathcal{Q}}
\def\C{\mathcal{C}}
\def\F{\mathcal{F}}
\DeclareMathOperator{\Var}{Var}

%%---DO NOT MODIFY THE FOLLOWING COMMANDS!---
%%──以下部分请不要修改!──
\begin{document}%
% \begin{CJK*}{GBK}{kai}
%-------版面的线框用页眉元素表现--------
%---第一页与众不同---
\newsavebox{\firstpgframe}
\sbox{\firstpgframe}{\parbox{157mm}{
\begin{center}
\begin{minipage}[t][153mm][t]{157mm}
\makebox[4mm][l]{\fbox{\parbox[t][153mm][t]{157mm}{\ }}}
\end{minipage}
\end{center}
}}
\vspace*{-6mm}

\newsavebox{\zdx}
\sbox{\zdx}
	{\parbox{412pt}{
% 	\centering \CJKfamily{kai}
% 代~码
(Code)\underline{\makebox[20mm][c]{\mycode}}%~学~号
(ID)\underline{\makebox[30mm][c]{\myStudentNumber}}~~~%姓~名
(Name)\underline{\makebox[30mm][c]{\myname}}

\vspace{3mm}
\dotfill{}%装
\dotfill{}%订
\dotfill{}%线
\dotfill{}(Gutter)
\dotfill{}
}}
\setlength{\marginparsep}{-10mm}
\reversemarginpar
\marginpar{
\parbox{10mm}{\vspace{3cm}
\rotatebox[origin=c]{90}{
\usebox{\zdx}
}
}}

%%Attach files (tex file;source code;figures;data file;rar archive;etc.)
%%请在此用命令\myattach{file}插入你的各种源文件（tex文件，源程序，图片文件，数据文件，压缩包，等等）
\myattach{\jobname.tex}
\myattach{L06MockAircraftControl.sq}
\myattach{L06TestImpulseResponse1.png}
\myattach{L06TestImpulseResponse2.png}
\myattach{L06TestImpulseResponse3.png}
\myattach{L06TestImpulseResponse4.png}
%\myattach{myprog01.sq}
\vskip 1cm

%%Main Text: Please provide your solutions here.
%%正文：请在此查看你的作业，并填写你的答案。


\begin{exercise-c26e158309505f61889ee3b749c66e08}%
\mydag
In the lecture,we have introduced the longitudinal aircraft dynamics.There are two actuator inputs,namely $\delta_{e}$ (elevator angle ($\delta_{e} > 0$ is down)) and $\delta_{t}$ (thrust).Moreover there are two disturbance inputs, $ u_{w}$(velocity of wind along body axis) and $v_{w}$(velocity of wind perpendicular to body axis).The outputs are $u$(aircraft speed) and climb rate $\dot{h}$($\dot{h}=-v+ 7.74\theta$) 
\begin{enumerate}
\item Please program with sysquake to analyze the stability of system.
\item Please program with sysquake to calculate the pulse matrix from ($u_{w}$ ,$v_{w}$ ) to ($u$,$\dot{h}$),and plot the pulse response to actuator.
\item Please program with sysquake to calculate the pulse matrix from ($\delta_{e}$ ,$\delta_{t}$ ) to ($u$,$\dot{h}$),and plot the pulse response to wind gusts.
\end{enumerate}
\end{exercise-c26e158309505f61889ee3b749c66e08}



\begin{solution-c26e158309505f61889ee3b749c66e08}
 Please put your solution and/or program here ... \\
 Implement a set of functions as below:
 \lstinputlisting{L06MockAircraftControl.sq}
 1:Run the following commands:
 \begin{verbatim}
A=[-0.003,0.039,0,-0.322;
-0.065,-0.319,7.74,0;
0.020,-0.101,-0.429,0;
0,0,1,0];
eig(A)
 \end{verbatim}
 We obtain the following result:
 \begin{verbatim}
 ans =
  -0.375 + 0.8818j
  -0.375 - 0.8818j
 -4.5786e-4 +6.7377e-2j
 -4.5786e-4 -6.7377e-2j
 \end{verbatim}
 All eigenvalues are of negative real part, hence the system is stable. \\
 2:Run the following commands:
 \begin{verbatim}
A=[-0.003,0.039,0,-0.322;
-0.065,-0.319,7.74,0;
0.020,-0.101,-0.429,0;
0,0,1,0];
B=[-A(:,1:2),[0.1,1;-0.18,-0.04;-1.16,0.598;0,0]];
C=[1,0,0,0;0,-1,0,7.74];
D=zeros(2,2);
[num,den]=ss2tf(A,B(:,1:2),C,D,1)
[num,den]=ss2tf(A,B(:,1:2),C,D,2)
\end{verbatim}
We obtain the following results:
\begin{verbatim}
num =
      3e-3  4.779e-3 4.2461e-3 4.1683e-3
   -6.5e-2 -2.7885e-2   -0.1002 -4.0766e-17
den =
         1     0.751    0.9234 4.2461e-3 4.1683e-3
num =
   -3.9e-2 -1.6731e-2 -3.2522e-2 -3.296e-17
    -0.319   -0.1403 -1.4981e-3 -4.1683e-3
den =
         1     0.751    0.9234 4.2461e-3 4.1683e-3
\end{verbatim}
Run the following command to plot impulse response to WIND GUST. 
\begin{verbatim}
plotSystemOutput(1,'impulse')
plotSystemOutput(2,'impulse')
\end{verbatim}
We obtain the following results:\newpage
 \begin{figure}[h!]
 \includegraphics[width=\linewidth]{L06TestImpulseResponse1.png}
 \end{figure}
 \begin{figure}[h!]
 \includegraphics[width=\linewidth]{L06TestImpulseResponse2.png}
 \end{figure}
 Note:\\
 Curve in red: u\\
 Curve in green: h\\
3:Run the following commands:
\begin{verbatim}
A=[-0.003,0.039,0,-0.322;
-0.065,-0.319,7.74,0;
0.020,-0.101,-0.429,0;
0,0,1,0];
B=[-A(:,1:2),[0.1,1;-0.18,-0.04;-1.16,0.598;0,0]];
C=[1,0,0,0;0,-1,0,7.74];
D=zeros(2,2);
[num,den]=ss2tf(A,B(:,3:4),C,D,1)
[num,den]=ss2tf(A,B(:,3:4),C,D,1)
\end{verbatim}
We obtain the following results:
\begin{verbatim}
num =
       0.1  6.778e-2    0.1122    0.1133
      0.18  8.426e-2   -2.7204 3.4403e-3
den =
         1     0.751    0.9234 4.2461e-3 4.1683e-3
num =
         1    0.7464    0.9059 -6.2726e-2
      4e-2  8.228e-2    1.5357     0.104
den =
         1     0.751    0.9234 4.2461e-3 4.1683e-3
\end{verbatim}
Run the following command to plot impulse response to ACTUATOR. 
\begin{verbatim}
plotSystemOutput(3,'impulse')
plotSystemOutput(4,'impulse')
\end{verbatim}
We obtain the following results:\newpage
 \begin{figure}[h!]
 \includegraphics[width=\linewidth]{L06TestImpulseResponse3.png}
 \end{figure}
 \begin{figure}[h!]
 \includegraphics[width=\linewidth]{L06TestImpulseResponse4.png}
 \end{figure}
 Note:\\
 Curve in red: u\\
 Curve in green: h\\
\end{solution-c26e158309505f61889ee3b749c66e08}



\begin{exercise-c26e158309505f61889ee3b749c66e08}%
\mydag
In the lecture, we have introduced the masses,spings and dampers system.$u_{1}$ is tention between 1st and 2nd masses,and $u_{2}$ is tention between 2rd and 3rd masses.y is displacement of mass 1,2,3.
\begin{enumerate}
\item Please program with sysquake to plot the pulse response.
\item $u_{1}$ affects third mass less than other two, try to justify.
\item $u_{2}$ affects first mass later than other two, try to justify.
\end{enumerate}
\end{exercise-c26e158309505f61889ee3b749c66e08}



\begin{solution-c26e158309505f61889ee3b749c66e08}
 Please put your solution and/or program here ... 
 %\lstinputlisting{myprog01.sq}
\end{solution-c26e158309505f61889ee3b749c66e08}




\begin{exercise-c26e158309505f61889ee3b749c66e08}%
\mydag
We know that transfer function is a mathematical model of linear time-invariant system.
 \begin{enumerate}
\item Can you use transfer function to describle the linear time-varying system? Justify your conclusion. 
\item Description function is used to describle nonlinear system, can you give a brief introduction to description function method?
\end{enumerate}
\end{exercise-c26e158309505f61889ee3b749c66e08}

\begin{solution-c26e158309505f61889ee3b749c66e08}
 Please put your solution and/or program here ... \\
 1:No. By definition, transfer function describes relationship between input and zero-state response. Given that $G(s)=C(sI-A)^{-1}B+D$, for a time varying system, we obtain that the 'transfer function' is time-varying. 
 2:The key idea of description function is to analyze a non-linear system by linearizing a non-linear function with first harmonic approximation, if a system meets certain constraints. These constraints include:
 \begin{enumerate}
\item The system can be decomposed into a cascade connection of linear component and non-linear component. 
\item The input and output of the non-linear component is symmetrical to the origin (e.g. the response to sinusoidal input is DC-balanced). 
\item The linear component features satisfatory low-pass property. 
\end{enumerate}
 Hypothetically if we apply sinusoidal input to a non-linear system, we obtain the output(represented as linear combination of sinusoidal response under different frequencies). If the amplitude of the first harmonic component is relatively greater than the others (e.g the other components can be negleted), we approximate the original non-linear system by another system in which the response consists of the first harmonic component only, represented by the describing function. \\
 For linear component, we can apply Nyquist criterion, and we obtain that $-\frac{1}{N(A)}$ plays a role just the same as that of point $(-1,0j)$ in Nyquist criterion. With this method we may judge the stability of the system and determine frequency and amplitude of of a self-excited oscillation that may occur. 
 %\lstinputlisting{myprog01.sq}
\end{solution-c26e158309505f61889ee3b749c66e08}



\begin{exercise-c26e158309505f61889ee3b749c66e08}%
\mydag
Suppose $A=\{1,2,3,\cdots,n,\cdots\}$ and $B=\{1,4,9,\cdots,n^{2},\cdots\}$
\begin{enumerate}
\item Show that which set of $A$ and $B$ is larger?(This problem is firstly proposed by Galileo)
\item Can you find one-to-one mapping between the elements of set $A$ and set $B$?
\item Read some set theory knowledge to find out how Cantor solve this interesting and surprising problem.
\end{enumerate}
\end{exercise-c26e158309505f61889ee3b749c66e08}

\begin{solution-c26e158309505f61889ee3b749c66e08}
 Please put your solution and/or program here ... \\
 1:They are equivalently large. \\
 2:The mapping would be:
 $$A\mapsto B:y=f_{1}(x)=x^{2},x\in A,y\in B$$
 or equivalently:
 $$B\mapsto A:y=f_{2}(x)=\sqrt{x},x\in B,y\in A$$.
 %\lstinputlisting{myprog01.sq}
\end{solution-c26e158309505f61889ee3b749c66e08}


% \end{CJK*}
\end{document}